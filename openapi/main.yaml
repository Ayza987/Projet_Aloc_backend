openapi: "3.0.3"
info:
  title: "Allocation API"
  description: "Backend application for resources allocation system"
  version: "1.0.0"
servers:
  - url: "http://localhost:8080"
    description: "Local server"

tags:
  - name: "User"
    description: "Operations on users"
  - name: "Demand"
    description: "Operations on requests"
  - name: "Resource"
    description: "Operations on resources"
  - name: "Allocation"
    description: "Operations on allocations"
paths:
  /api/account/admin/auth/signup:
    post:
      tags:
        - "User"
      summary: "Create an account"
      description: "Create an endpoint for signing up the users"
      operationId: signup
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SignupRequestDTO'
      responses:
        '200':
          description: Success
        '403':
          description: Forbidden access
        '400':
          description: Bad Request
  /api/account/auth/signupAsAdmin:
    post:
      tags:
        - "User"
      summary: "Create an admin account"
      description: "Create an endpoint for signing up the admins"
      operationId: signupAsAdmin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SignupRequestDTO'
      responses:
        '200':
          description: Success
        '403':
          description: Forbidden access
        '400':
          description: Bad Request
  /api/account/auth/login:
    post:
      summary: "Login"
      description: "Create an endpoint to login the users"
      operationId: login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequestDTO'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponseDTO'
        '403':
          description: Forbidden access
        '400':
          description: Bad Request
  /api/account/user/{id}:
    patch:
      tags:
        - "User"
      description: "Create an endpoint for updating a user"
      operationId: updateUser
      parameters:
        - name: id
          in: path
          required: true
          description: "The id of the user to update"
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequestDTO'
      responses:
        '200':
          description: "User updated successfully"
        '404':
          description: Not found
  /api/account/admin/users:
    get:
      tags:
        - "User"
      description: "Get all users"
      operationId: getAllUsers
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserDTO'
        '404':
          description: Not found
  /api/account/admin/users/{id}:
    get:
      tags:
        - "User"
      description: "Get a user by its id"
      operationId: getUser
      parameters:
        - name: id
          in: path
          required: true
          description: "The id of the user to get"
          schema:
            type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserDTO'
        '404':
          description: Not found
  /api/account/admin/users/delete/{id}:
      delete:
        tags:
          - "User"
        description: "Delete a user"
        operationId: deleteUser
        parameters:
          - name: id
            in: path
            required: true
            schema:
              type: string
        responses:
          '200':
            description: "User deleted successfully"
          '404':
              description: "Not Found"
  /api/account/admin/users/search:
    get:
      tags:
        - "User"
      summary: "Search users"
      description: "Get the list of all the users according to a research"
      operationId: searchUsers
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserDTO'
        '404':
          description: Not found
  /api/account/user/updatePassword:
    post:
      tags:
        - "User"
      summary: "update password"
      description: "Create an endpoint to update the password of an authenticated User"
      operationId: updatePassword
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdatePasswordDTO'
      responses:
        '200':
          description: Success
        '403':
          description: Forbidden access
        '400':
          description: Bad Request
  /api/createDemand:
    post:
      tags:
        - "Demand"
      summary: "Create a demand"
      description: "Create an endpoint for registering a demand"
      operationId: createDemand
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDemandRequestDTO'
      responses:
        '200':
          description: "Request created successfully"
        '400':
          description: "Bad Request"
  /api/admin/demands:
      get:
        tags:
          - "Demand"
        summary: "Get all demands"
        description: "Create an endpoint to get all the demands"
        operationId: getAllDemands
        responses:
          '200':
            description: Success
            content:
              application/json:
                schema:
                  type: array
                  items:
                    $ref: '#/components/schemas/DemandDTO'
          '404':
            description: Not found
  /api/demands/user:
    get:
      tags:
        - "Demand"
      summary: "Get authenticated user demands"
      description: "Create an endpoint to get the demands of an authenticated user"
      operationId: getAuthenticatedUserDemands
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                   $ref: '#/components/schemas/DemandDTO'
        '404':
          description: Not found
        '400':
          description: Bad request
  /api/demand/{id}:
    patch:
      tags:
        - "Demand"
      summary: "Update a demand"
      description: "Create an endpoint to update a demand"
      operationId: updateDemand
      parameters:
        - name: id
          in: path
          required: true
          description: "The id of the user to update"
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateDemandDTO'
      responses:
        '200':
          description: Success
        '404':
          description: Not Found
  /api/demands/delete/{id}:
    delete:
      tags:
        - "Demand"
      summary: "Delete a demand"
      description: "Create an endpoint to delete a demand"
      operationId: deleteDemand
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: "Demand deleted successfully"
        '404':
          description: "Not Found"
  /api/demands/updateUrgency/{id}:
    patch:
      tags:
        - "Demand"
      description: "Change the urgency of a demand"
      operationId: updateUrgency
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Success
        '404':
          description: Not found
  /api/admin/demand/allocate:
    post:
      tags:
        - "Demands"
      description: "Allocate a resource"
      operationId: allocateResource
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AllocateResourceRequestDTO'
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AllocatedResourceDTO'
        '400':
          description: Bad request
        '404':
          description: Not found
  /api/admin/demand/reject:
    post:
      tags:
        - "Demands"
      description: "Reject an allocation demand"
      operationId: rejectDemand
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RejectDemandRequestDTO'
      responses:
        '200':
          description: Success
        '400':
          description: Bad request
        '404':
          description: Not found
  /api/demands/search:
    get:
      tags:
        - "Demand"
      summary: "Search demands"
      description: "Get the list of all the demands according to a research"
      operationId: searchDemands
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                   $ref: '#/components/schemas/DemandDTO'
        '404':
          description: Not found
  /api/admin/createresource:
    post:
      tags:
        - "Resource"
      summary: "Create a resource"
      description: "Create and endpoint to add a new resource"
      operationId: createResource
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateResourceRequestDTO'
      responses:
        '200':
          description: "Resource created successfully"
        '400':
          description: "Bad Request"
  /api/admin/resources:
    get:
      tags:
        - "Resource"
      summary: "Get all resources"
      description: "Get the list of all the resources"
      operationId: getAllResources
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ResourceDTO'
        '404':
          description: Not found
  /api/resources/user:
    get:
      tags:
        - "Resource"
      summary: "Get all resources for user"
      description: "Get the list of all the resources for the user interface"
      operationId: getAllResourcesForUser
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ResourceForUserDTO'
        '404':
          description: Not found
  /api/admin/resources/{id}:
    get:
      tags:
        - "Resource"
      summary: "Get a resource"
      description: "Create an endpoint to get a resource by its id"
      operationId: getResource
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResourceDTO'
        '404':
          description: Not found
  /api/admin/resource/{id}:
    patch:
      tags:
        - "Resource"
      summary: "Update a resource"
      description: "Create an endpoint to update a resource"
      operationId: updateResource
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ResourceDTO'
      responses:
        '200':
          description: Success
        '404':
          description: Not found
  /api/admin/resources/delete/{id}}:
    delete:
      tags:
        - "Resource"
      summary: "Delete a resource"
      description: "Create an endpoint to delete a resource"
      operationId: deleteResource
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: "Resource deleted successfully"
        '404':
          description: "Not Found"
  /api/admin/resources/availability/{id}:
    patch:
      tags:
        - "Resource"
      description: "Change the availability status of a resource"
      operationId: updateAvailability
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResourceDTO'
        '404':
          description: Not found
  /api/admin/resources/search:
    get:
      tags:
        - "Resource"
      summary: "Search resources"
      description: "Get the list of all the resources according to a research"
      operationId: searchResources
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ResourceDTO'
        '404':
          description: Not found
  /api/allocation/allocatedResources/search:
    get:
      tags:
        - "Allocation"
      summary: "Search allocated resources"
      description: "Get the list of all the allocated resources according to a research"
      operationId: searchAllocatedResources
      parameters:
        - name: userEmail
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AllocatedResourceDTO'
        '404':
          description: Not found
  /api/allocation/admin/allocatedResources:
    get:
      tags:
        - "Allocation"
      summary: "Get all allocated resources"
      description: "Get the list of all the allocated resources"
      operationId: getAllocatedResources
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AllocatedResourceDTO'
        '404':
          description: Not found
  /api/allocation/allocatedResource/user:
    get:
      tags:
        - "Allocation"
      summary: "Get allocated resources"
      description: "Get allocated resources of an authenticated user"
      operationId: getAuthenticatedUserAllocatedResources
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AllocatedResourceDTO'
        '404':
          description: Not found
  /api/allocation/admin/allocatedResource/updateStatus/{id}:
    patch:
      tags:
        - "Allocation"
      description: "Change the status of an allocated resource"
      operationId: updateStatus
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Success
        '404':
          description: Not found
  /api/account/password/reset-request:
    post:
      summary: "Reset password request"
      operationId: requestPasswordReset
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetRequestDTO'
      responses:
        '200':
          description: Success
        '404':
          description: User not found
  /api/account/password/reset:
    post:
      summary: "Reset password"
      operationId: passwordReset
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetDTO'
      responses:
        '200':
          description: Success
        '400':
          description: Bad Request
  /api/notifications/user:
    get:
      summary: "Get notifications of an authenticated user"
      operationId: getNotifications
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Success
          content:
            application/json:
             schema:
               $ref: '#/components/schemas/NotificationDTO'
        '404':
          description: Not found
        '403':
          description: Unauthorized
  /api/notifications/count:
    get:
      summary: "Get the number of unread notifications of an authenticated user"
      operationId: countNotifications
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: string
                    example: "5"
        '404':
          description: Not found
        '403':
          description: Unauthorized
  /api/notifications/markRead/{id}:
    post:
      summary: "Mark a notification as read"
      operationId: markReadNotification
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Success
        '404':
          description: Not found









components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    LoginRequestDTO:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          example: "user@entreprise.com"
        password:
          type: string
          format: password

    LoginResponseDTO:
      type: object
      properties:
        token:
          type: string
        isAdmin:
          type: boolean
          example: true

    SignupRequestDTO:
      type: object
      required:
        - name
        - surname
        - email
      properties:
        name:
          type: string
          example: "name"
        surname:
          type: string
          example: "surname"
        email:
          type: string
          format: email
          example: "user@entreprise.com"

    UpdatePasswordDTO:
      type: object
      required:
        - email
        - password
        - newPassword
      properties:
        email:
          type: string
        password:
          type: string
        newPassword:
          type: string


    UpdateUserRequestDTO:
      type: object
      properties:
        email:
          type: string
        name:
          type: string
        surname:
          type: string

    UserDTO:
     type: object
     properties:
       id:
          type: string
          format: uuid
       name:
          type: string
       surname:
          type: string
       email:
          type: string

    DemandUrgency:
      type: string
      enum:
        - URGENT
        - NOT_URGENT

    DemandStatus:
      type: string
      enum:
        - PENDING
        - APPROVED
        - REJECTED

    CreateDemandRequestDTO:
     type: object
     required:
       - resource_name
       - quantity
       - description
       - justification
       - urgency
       - due_date
     properties:
       resource_name:
         type: string
       quantity:
         type: integer
       description:
         type: string
       justification:
         type: string
       urgency:
           $ref: '#/components/schemas/DemandUrgency'
       due_date:
         type: string

    DemandDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
        user_name:
          type: string
        user_email:
          type: string
        resource_name:
          type: string
        description:
          type: string
        justification:
          type: string
        urgency:
            $ref: '#/components/schemas/DemandUrgency'
        due_date:
          type: string
        quantity:
          type: integer
        status:
          $ref: '#/components/schemas/DemandStatus'
        date_time:
          type: string

    UpdateDemandDTO:
      type: object
      properties:
        user_name:
          type: string
        user_email:
          type: string
        resource_name:
          type: string
        description:
          type: string
        justification:
          type: string
        urgency:
            $ref: '#/components/schemas/DemandUrgency'
        due_date:
          type: string
        quantity:
          type: integer
        status:
          $ref: '#/components/schemas/DemandStatus'

    ResourceType:
      type: string
      enum:
        - HARDWARE
        - SOFTWARE
        - OTHER

    CreateResourceRequestDTO:
      type: object
      required:
        - name
        - type
        - description
        - isAvailable
        - quantity
      properties:
        name:
          type: string
        type:
            $ref: '#/components/schemas/ResourceType'
        description:
          type: string
        isAvailable:
          type: boolean
        quantity:
          type: integer

    ResourceDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        type:
            $ref: '#/components/schemas/ResourceType'
        description:
          type: string
        isAvailable:
          type: boolean
        quantity:
          type: integer

    AllocationStatus:
      type: string
      enum:
        - RETURNED
        - NOT_RETURNED
        - NON_RETURNABLE

    AllocateResourceRequestDTO:
      type: object
      required:
        - demand_id
        - user_email
        - resource_name
        - quantity
      properties:
        demand_id:
          type: string
          format: uuid
        user_email:
          type: string
        resource_name:
          type: string
        quantity:
          type: integer

    RejectDemandRequestDTO:
      type: object
      required:
        - demand_id
        - user_email
        - resource_name
        - reject_reason
      properties:
        demand_id:
          type: string
          format: uuid
        user_email:
          type: string
        resource_name:
          type: string
        reject_reason:
          type: string

    AllocatedResourceDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
        demand_id:
          type: string
          format: uuid
        user_email:
          type: string
        resource_name:
          type: string
        quantity:
          type: integer
        demand_date:
          type: string
        allocation_date:
          type: string
        status:
            $ref: '#/components/schemas/AllocationStatus'

    PasswordResetRequestDTO:
      type: object
      required:
        - email
      properties:
        email:
          type: string
          format: email
          example: "user@example.com"

    PasswordResetDTO:
      type: object
      required:
        - token
        - newPassword
      properties:
        token:
          type: string
        newPassword:
          type: string

    NotificationDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
        status:
          $ref: '#/components/schemas/DemandStatus'
        user_email:
          type: string
        reject_reason:
          type: string

    ResourceForUserDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        type:
          $ref: '#/components/schemas/ResourceType'
        description:
          type: string




















